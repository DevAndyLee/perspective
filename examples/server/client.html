<!--
   
   Copyright (c) 2017, the Perspective Authors.
   
   This file is part of the Perspective library, distributed under the terms of
   the Apache License 2.0.  The full license can be found in the LICENSE file.

-->

<!DOCTYPE html>
<html>

<head>

    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">

    <script src="perspective.view.js"></script>
    <script src="hypergrid.plugin.js"></script>
    <script src="highcharts.plugin.js"></script>

    <script src="perspective.js"></script>

    <link rel='stylesheet' href="styles.css">
    <link rel='stylesheet' href="material.css" is="custom-style">
    

</head>

<body>

    <!-- The Perspective instance on the server feeds the client Perspective with data. -->
    <perspective-viewer></perspective-viewer>

    <script>
        // Wait for the viewer to load, then:
        window.addEventListener("WebComponentsReady", function() {
            const elem = document.getElementsByTagName("perspective-viewer")[0];
            const websocket_url = window.location.origin.replace("http", "ws");

            // Bind to the server's worker instead of instantiating a Web Worker.
            const worker = perspective.worker(websocket_url);

            // Bind the viewer to the server's Perspective table and associated view
            elem.load(worker.open_table("table_one"));
            const view = worker.open_view("view_one");

            // Update client Perspective with new data when the server updates
            view.on_update(
                function(updated_rows) {
                    console.log(updated_rows);
                },
                {mode: "rows"}
            );

        });
    </script>

</body>

</html>